---
layout: post
title: Connect Four
thumbnail-path: "img/connect_four.JPG"
short-description: The classic Connect Four game with the convenience of a digital play experience.

---

{:.center}
![]({{site.baseurl}}/img/connect_four.JPG)
{:.center}
You can play connect four <a href='https://dry-savannah-43148.herokuapp.com/'>here</a>!

## Summary

My implementaion of Connect Four attempts to directly mimic the gameplay of the classic board game. Given the added flexibility afforded by hosting the game on a digital platform, there are also a few extra features of my own design.


## Explanation

As part of the Bloc curriculum, there are several career preparation checkpoints. One such checkpoint described the relatively common practice of giving a potential new hire a project to work on as part of the interview process. The candidate is given one day to complete whatever project was assigned. Building Connect Four was my effort at showing what I could build in one day. 

## Problems

The following are issues that came up during development of the project.  

1.Which framework to use? As with any project, the first step can be the hardest. Deciding how to implement any project depends on whether you choose to use bare bones Javascript, Angular JS, Ruby, or whatever other implementation one has access to. For this project, I ultimately decided to use the Angular JS framework.

2. How is the best way to represent the game board? Of course, intitally, the board starts out as 42 empty slots arranged into a grid pattern. Would a matrix class need to be created, or would an array suffice?

3. How to determine a winner? Checking that 4 pieces of the same color align in any of the vertical, horizontal, or diagonal directions must be performed at every chip insertion.

4. Accidental clicks happen. I had to find some way to allow for a reset to occur which would erase the last move to put that board state back to its previous condition.

## Solutions

**The** problem of which framework to use seemed to answer itself. My experience up to that point with web development involved Javascript and Ruby. With Ruby, the only interaction with the web had come with Ruby on Rails. A Connect Four application doesn't need to have data persisted, so Javascript won the decision. Given that I needed a system that interacted with periodic, event-driven input from the user, either of plain old Javascript or AngularJS would work. Angular provides some nice, built-in associations, so I elected to leverage that framework.  

**There** are actually two separate problems of how to represent the game board. The first problem is how to represent the game board in memory, or as a Javascript construct. The second is how to represent the board to the user everytime a game chip is inserted into a column. So to solve the first problem, I indeed set up the board as an object.

{% highlight javascript %}
var Board = {};
{% endhighlight %}

I gave it a `matrix` property that is an array. The best way to picture the array is as a list of columns, each of which contain a list of rows:

{% highlight javascript %}
/*Board.matrix is an array of columns. each column is an array of rows. The bottom of each column is index 0
         *so the bottom-left of the Connect Four board is Board.matrix[0][0]
         *the bottom right slot is Board.matrix[6][0]
         etc.*/
         Board.matrix=[];
//initialize the board with all empty slots
         for(var i=0;i<7;i++){
             Board.matrix.push([0,0,0,0,0,0]);
         }
{% endhighlight %}


Elements in the matrix, then can be accessed by a command like `Board.matrix[3][2]`

{:.center}
![]({{site.baseurl}}/img/board_object.JPG)

But now remains the problem of representing this to the user. At first, we can just represent everything as a blank slot image. But there are 42 individual `.slots` DOM objects that were generated by this bit of code:

{% highlight javascript %}
<tr class="slot-rows" ng-repeat="n in game.board.rows">
    <td class="slots" ng-repeat="n in game.board.cols"><img class="empty" src="http://i.imgur.com/O1lQF0g.png"</td>
</tr>
{% endhighlight %}

So the jQuery object `$(".slots")` is an array with slot DOM elements whose inner HTML we need to change in order to make it appear as either a red or black chip.
`$(".slots")` is arranged like so:

{:.center}
![]({{site.baseurl}}/img/DOM_object.JPG)

After some inspection, we realize that we can relate the two with this equation:

{% highlight javascript %}
$(".slots")[((6-replaceIndex)*7-1) - (6-column)]
{% endhighlight %}

where `column` is the index in `Board.matrix` of the `arrow` DOM element that the user clicked, and `replaceIndex` is the lowest index within the column array that has yet to be filled. (whew!)

**To** determine a winner, we need to look in eight directions around whatever chip was just inserted: up, down, left, right, northeast, northwest, southeast, and southwest. The simplest thing to do is to draw 4 arrays around a chip whenever it is inserted, and if any one of them has the same value in 4 consecutive indices, then the winner of the game is the player that just inserted the chip.

There is an intersting insight into the mechanics of different languages here. My initial implementaion was something like

{% highlight javascript %}
for(var i=0; i < arr.length; i++){
    if (arr[i]){
        consecutiveCount++;
    }
}
{% endhighlight %}

 The issue comes down to what different languages consider Truthy or Falsy. Our `Board.matrix` was initialized with many 0's. A 1 or 2 replaced the zero whenever the corresponding player inserted a chip there. Depending on the language being used, the Integer 0 may be true or false. Javascript considers 0 a _Falsy_ value. Ruby, on the other hand, considers 0 _Truthy_. This bit of information was an interesting learning for me.
 
**Finally**, I needed to implement a way to reset the game board by one move. I solved this by maintaining object properties `hotColumn` and `hotRow`, which together contained the coordinates of the most-recently-placed chip. Using the same relation described above, the board state and DOM state could be reset by one move when necessary.


## Results

The end result is a fully functional connect four game! The game will alert when a winner is declared, and there's no messy clean up between each game. Don't forget to give the game a try at my heroku repo <a href='https://dry-savannah-43148.herokuapp.com/'>here</a>!

## Conclusion

This project served and serves as a testament to what I can accomplish in one day's work. These are the exact kinds of problems that I envision a fulfilling, varied, challenging career comprises.

     

































